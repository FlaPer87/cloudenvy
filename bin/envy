#!env python
# vim: tabstop=4 shiftwidth=4 softtabstop=4

import argparse
import logging
import sys

from cloudenvy import fabfile


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Process some shiz.')
    parser.add_argument('cmd')
    parser.add_argument("-v", "--verbosity", action="count",
                        help="increase output verbosity")
    args = parser.parse_args()

    if args.verbosity == 3:
      logging.getLogger().setLevel(logging.DEBUG)
      logging.getLogger('novaclient').setLevel(logging.DEBUG)
    elif args.verbosity == 2:
      logging.getLogger().setLevel(logging.DEBUG)
      logging.getLogger('novaclient').setLevel(logging.INFO)
    elif args.verbosity == 1:
      logging.getLogger().setLevel(logging.INFO)

    try:
        fab_func = getattr(fabfile, args.cmd)
    except AttributeError:
        print 'Invalid command.'
        sys.exit(1)
    else:
        fab_func()


